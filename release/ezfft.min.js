function fft(a,e,t=0,r=.001){if(data={time:{realPart:a,imagPart:t,time:[]},frequency:{realPart:[],imagPart:[],amplitude:[],phase:[],frequency:[]},fs:e,samplingTime:0},0==data.fs)throw"Sample frequency cannot be zero.";data.samplingTime=data.time.realPart.length/e;for(let a=0;a<data.time.realPart.length;a++)data.time.time[a]=a/e;data.time.imagPart.length!=data.time.realPart.length&&(data.time.imagPart=newArrayOfZeros(data.time.realPart.length));let n=data.time.realPart.map(function(a){return a}),f=data.time.imagPart.map(function(a){return a});[data.frequency.realPart,data.frequency.imagPart]=transform(n,f);for(let a=0;a<data.frequency.realPart.length;a++)data.frequency.amplitude[a]=Math.sqrt(Math.pow(data.frequency.realPart[a],2)+Math.pow(data.frequency.imagPart[a],2))/(data.frequency.realPart.length/2),data.frequency.phase[a]=Math.atan2(data.frequency.imagPart[a],data.frequency.realPart[a]),data.frequency.frequency[a]=a/data.samplingTime,data.frequency.amplitude[a]<r&&(data.frequency.amplitude[a]=0,data.frequency.phase[a]=0);let i=data.frequency.amplitude.slice(data.frequency.amplitude.length/2,data.frequency.amplitude.length);return i.reverse().forEach(function(a){data.frequency.amplitude.unshift(a),data.frequency.amplitude.pop()}),(i=data.frequency.phase.slice(data.frequency.phase.length/2,data.frequency.phase.length)).reverse().forEach(function(a){data.frequency.phase.unshift(a),data.frequency.phase.pop()}),(i=data.frequency.frequency.slice(data.frequency.frequency.length/2,data.frequency.frequency.length)).forEach(function(a){data.frequency.frequency.unshift(-(a-(e-1)/2)),data.frequency.frequency.pop()}),data.samplingTime-=1/e,data}function ifft(a,e,t=0,r=0,n=0,f=.001){data={time:{realPart:[],imagPart:[],time:[]},frequency:{realPart:[],imagPart:[],amplitude:a,phase:[],frequency:e},fs:0,samplingTime:0},data.samplingTime=1/Math.abs(e[1]-e[0]),data.fs=2*e.map(Math.abs).reduce(function(a,e){return Math.max(a,e)});for(let a=0;a<data.samplingTime*data.fs;a++)data.time.time[a]=a/data.fs;if(void 0===t.length?data.frequency.phase=newArrayOfZeros(a.length):data.frequency.phase=t,void 0===r.length&&void 0===n.length)for(let a=0;a<data.frequency.amplitude.length;a++)data.frequency.realPart[a]=data.frequency.amplitude[a]*data.frequency.amplitude.length/(2*Math.sqrt(1+Math.pow(Math.tan(data.frequency.phase[a]),2))),data.frequency.imagPart[a]=data.frequency.realPart[a]*Math.tan(data.frequency.phase[a]);else data.frequency.realPart=r.map(function(a){return a}),data.frequency.imagPart=n.map(function(a){return a});let i=data.frequency.realPart.map(function(a){return a}),u=data.frequency.imagPart.map(function(a){return a});[data.time.imagPart,data.time.realPart]=inverseTransform(i,u);for(let a=0;a<data.time.imagPart.length;a++)data.time.imagPart[a]<f&&(data.time.imagPart[a]=0);return data}function transform(a,e){var t=a.length;if(t!=e.length)throw"Mismatched lengths";return 0==t?void 0:0==(t&t-1)?transformRadix2(a,e):transformBluestein(a,e)}function inverseTransform(a,e){return transform(e,a)}function transformRadix2(a,e){var t=a.length;if(t!=e.length)throw"Mismatched lengths";if(1!=t){for(var r=-1,n=0;n<32;n++)1<<n==t&&(r=n);if(-1==r)throw"Length is not a power of 2";var f=new Array(t/2),i=new Array(t/2);for(n=0;n<t/2;n++)f[n]=Math.cos(2*Math.PI*n/t),i[n]=Math.sin(2*Math.PI*n/t);for(n=0;n<t;n++){if((d=reverseBits(n,r))>n){var u=a[n];a[n]=a[d],a[d]=u,u=e[n],e[n]=e[d],e[d]=u}}for(var l=2;l<=t;l*=2){var o=l/2,c=t/l;for(n=0;n<t;n+=l)for(var d=n,m=0;d<n+o;d++,m+=c){var h=d+o,s=a[h]*f[m]+e[h]*i[m],y=-a[h]*i[m]+e[h]*f[m];a[h]=a[d]-s,e[h]=e[d]-y,a[d]+=s,e[d]+=y}}return[a,e]}}function reverseBits(a,e){for(var t=0,r=0;r<e;r++)t=t<<1|1&a,a>>>=1;return t}function transformBluestein(a,e){var t=a.length;if(t!=e.length)throw"Mismatched lengths";for(var r=1;r<2*t+1;)r*=2;for(var n=new Array(t),f=new Array(t),i=0;i<t;i++){var u=i*i%(2*t);n[i]=Math.cos(Math.PI*u/t),f[i]=Math.sin(Math.PI*u/t)}var l=newArrayOfZeros(r),o=newArrayOfZeros(r);for(i=0;i<t;i++)l[i]=a[i]*n[i]+e[i]*f[i],o[i]=-a[i]*f[i]+e[i]*n[i];var c=newArrayOfZeros(r),d=newArrayOfZeros(r);c[0]=n[0],d[0]=f[0];for(i=1;i<t;i++)c[i]=c[r-i]=n[i],d[i]=d[r-i]=f[i];var m=new Array(r),h=new Array(r);convolveComplex(l,o,c,d,m,h);for(i=0;i<t;i++)a[i]=m[i]*n[i]+h[i]*f[i],e[i]=-m[i]*f[i]+h[i]*n[i];return[a,e]}function convolveReal(a,e,t){var r=a.length;if(r!=e.length||r!=t.length)throw"Mismatched lengths";convolveComplex(a,newArrayOfZeros(r),e,newArrayOfZeros(r),t,newArrayOfZeros(r))}function convolveComplex(a,e,t,r,n,f){var i=a.length;if(i!=e.length||i!=t.length||i!=r.length||i!=n.length||i!=f.length)throw"Mismatched lengths";a=a.slice(),e=e.slice(),t=t.slice(),r=r.slice(),transform(a,e),transform(t,r);for(var u=0;u<i;u++){var l=a[u]*t[u]-e[u]*r[u];e[u]=e[u]*t[u]+a[u]*r[u],a[u]=l}inverseTransform(a,e);for(u=0;u<i;u++)n[u]=a[u]/i,f[u]=e[u]/i}function newArrayOfZeros(a){for(var e=[],t=0;t<a;t++)e.push(0);return e}module.exports={fft:fft,ifft:ifft};